<launch>

    <arg name="bag_file_use" default="true" />
    <arg name="config_file" default="$(find mloam)/../config/config_gz_bay.yaml" />

    <arg name="run_mloam" default="true" />
    <arg name="run_aloam" default="true" />

    <arg name="mloam_result_save" default="0"/>
    <arg name="output_path" default="/home/jjiao/catkin_ws/src/localization/rpg_trajectory_evaluation/results/simu_jackal_mloam/test/mloam/SR02/"/>
    <arg name="mloam_odom_path" default="stamped_mloam_odom_estimate.txt"/>
    <arg name="mloam_map_path" default="stamped_mloam_map_estimate.txt"/>
    <arg name="mloam_gt_path" default="stamped_groundtruth.txt"    />

    <param name="use_sim_time" value="true" />

    <!-- Ros Bag -->
    <group if="$(arg bag_file_use)">
        <arg name="bag_file" default="/Monster/dataset/lidar_calibration/guangzhou_bay_20191231/1226ori_lidar.bag" />
        <node pkg="rosbag" type="play" name="rosbag" args="--clock --pause -r 1 $(arg bag_file)" />
    </group>

    <group if="$(arg run_mloam)">
        <node pkg="mloam" type="mloam_node_rt" name="mloam_node_rt" 
            args="$(arg config_file) $(arg mloam_result_save) $(arg output_path) $(arg mloam_odom_path) $(arg mloam_gt_path)" />
        <!-- <node pkg="mloam" type="lidar_mapper" name="lidar_mapper" 
            args="$(arg config_file) $(arg mloam_result_save) $(arg mloam_map_path)" output="screen"/> -->
    </group>

    <!-- publish static tf -->
    <!-- x y z yaw pitch roll -->
    <!-- x y z qx qy qz qw -->
    <node name="static_tf_world_base_into_world_sensor" pkg="tf" type="static_transform_publisher"
        args="0 0 0 0 0 0 1 world_base world 10"/>
    <node name="static_tf_world_sensor_into_base_sensor" pkg="tf" type="static_transform_publisher"
        args="0 0 0 0 0 0 1 world laser_0 10"/>

    <group if="$(arg run_aloam)">
        <include file="$(find aloam_velodyne)/launch/aloam_simu_jackal.launch">
            <arg name="aloam_odom_path" default="/home/jjiao/catkin_ws/src/localization/rpg_trajectory_evaluation/results/simu_jackal_mloam/test/mloam/SR03/stamped_aloam_odom_estimate.txt"/>
            <arg name="aloam_map_path" default="/home/jjiao/catkin_ws/src/localization/rpg_trajectory_evaluation/results/simu_jackal_mloam/test/mloam/SR03/stamped_aloam_map_estimate.txt"/>
        </include>
    </group>     

 </launch>
